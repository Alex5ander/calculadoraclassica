<!doctype>
<html>

<head>
	<meta charset="utf-8"/>
	<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, user-scalable=no"/>
	<title>Calculadora Clássica</title>
	<link rel="icon" type="image/png" href="icon.png"/>
	<style>
		body{
			background-color:coral;
		}
		#container{
			margin:0;
			width:100%;
			height:100%;
		}
		.btn{
			text-align:center;
			padding:0;
			background-color:rgba(255, 255, 255, .1);
			border:.1em solid;
			border-color:transparent;
			color:white;
			font-size:2em;
			user-select:none;
			outline:none;
			width:100%;
			height:100%;
			font-weight:bold;
			user-select:none;
			transition:.2s cubic-bezier(0.5, 1, 0.5, 1);
		}
		table{
			width:100%;
			height:74%;
		}
		tr{
			width:100%;
		}
		.btn:active{
			background-color:#50ffc2ff;
			border-color:white;
		}
		#display{
			text-decoration:none;
			user-select:none;
			color:white;
			border:none;
			padding:0;
			width:100%;
			text-align:right;
			font-size:3em;
			font-weight:bold;
			outline:none;
			background-color:rgba(255, 255, 255, .4);
		}
		.selecionado{
			background-color:rgba(255, 255, 255, .3);
		}
		#delete{
			width:100%;
			font-size:3em;
			height:auto !Important;
		}
	</style>
</head>

<body>
	<div id="container">
		<input id="display" type="text" disabled placeholder="0" value="0"/>
		<button class="btn" id="delete" >Excluir</button>
		<table>
			<tr>
				<td><button class="btn" id="btn_7" value="7">7</button></td>
				<td><button class="btn" id="btn_8" value="8">8</button></td>
				<td><button class="btn" id="btn_9" value="9">9</button></td>
				<td><button class="btn" id="btn_/" value="/">&divide;</button></td>
			</tr>
			<tr>
				<td><button class="btn" id="btn_4" value="4">4</button></td>
				<td><button class="btn" id="btn_5" value="5">5</button></td>
				<td><button class="btn" id="btn_6" value="6">6</button></td>
				<td><button class="btn" id="btn_*" value="*">&times;</button></td>
			</tr>
			<tr>
				<td><button class="btn" id="btn_1" value="1">1</button></td>
				<td><button class="btn" id="btn_2" value="2">2</button></td>
				<td><button class="btn" id="btn_3" value="3">3</button></td>
				<td><button class="btn" id="btn_-" value="-">&minus;</button></td>
			</tr>
			<tr>	
				<td><button class="btn" id="btn_0" value="0">0</button></td>
				<td><button class="btn" id="btn_." value=".">.</button></td>
				<td><button class="btn" id="btn_=" value="=">=</button></td>
				<td><button class="btn" id="btn_+" value="+">+</button></td>
			</tr>
		</table>
	</div>
	<script>
		for(var i = 0; i < 10; i++){
			var n = document.getElementById("btn_"+i);
			n.onclick = inserirNumero;
		}
		
		window.addEventListener("resize", resize);
		
		function resize(){
			var width = window.innerWidth;
			var height = window.innerHeight;
			
			var size = Math.min(width, height) * .1;
			
			var botoes = document.getElementsByClassName("btn");
			for(var i = 0; i < botoes.length; i++){
				botoes[i].style.fontSize = size+"px";
			}
			display.style.fontSize = size+"px";
		}
		
		var divisao = document.getElementById("btn_/");
		var multiplicacao = document.getElementById("btn_*");
		var subtracao = document.getElementById("btn_-");
		var adicao = document.getElementById("btn_+");
		
		var operadores = [divisao, multiplicacao, subtracao, adicao];
		
		var igual = document.getElementById("btn_=");
		var ponto = document.getElementById("btn_.");
		
		var display = document.getElementById("display");
		var deletar = document.getElementById("delete");
		
		divisao.onclick = inserirSimbolo;
		adicao.onclick = inserirSimbolo;
		subtracao.onclick = inserirSimbolo;
		multiplicacao.onclick = inserirSimbolo;
		igual.onclick = inserirSimbolo;
		
		deletar.onclick = excluir;
		ponto.onclick = inserirPonto;
		
		var visor = false;
		var v1 = null;
		var v2 = null;
		var result = false;
		var operador ="";
		var ope = "";
		function inserirNumero(e){
			e.preventDefault();
			if(result && ope == "="){
				result = false;
				v1 = null;
				//v2 = null;
			}
			if(visor == false){
				display.value = "0";
			}
			if(parseFloat(display.value) == 0 && display.value.match(/[.]{1}/) == null){
				display.value = this.value;
			}else{
				display.value += this.value;
			}
			visor = true;
		}
		
		function inserirPonto(e){
			e.preventDefault();
			if(visor == false){
				display.value = "0";
			}
			if(display.value.match(/[.]{1}/) == null){
				if(display.value == ""){
					display.value = "0"+this.value;
				}else{
					display.value += this.value;
				}
			}
			visor = true;
		}
		
		function inserirSimbolo(e){
			e.preventDefault();
			//salva operador usado;
			ope = this.value;
			for(var i = 0; i < operadores.length; i++){
				if(operadores[i].classList.contains("selecionado") && this.id != operadores[i].id){
					operadores[i].classList.remove("selecionado");
					if(this.value != "="){
						this.classList.add("selecionado");
					}
					break;
				}else if(this.value != "="){
					this.classList.add("selecionado");
				}
			}
			if(ope != "="){
				if(v1 == null){
					v1 = parseFloat(display.value);
					visor = false;
				}else if(visor){
					v2 = parseFloat(display.value);
					result = calcular(operador, v1, v2);
					display.value = result;
					v1 = result;
					visor = false;
					result = false;
				}
				operador = this.value;
			}else if(v1 != null){
				if(visor){
					v2 = parseFloat(display.value);
				}
				if(v2 == null){
					if(operador == "-" || operador == "+"){
						v2 = parseFloat(display.value);
						v1 = 0;
					}else{
						v2 = parseFloat(display.value);
					}
				}
				result = calcular(operador, v1, v2);
				display.value = result;
				v1 = result;
				visor = false;
				deletar.textContent = "Limpar";
			}else{
				v1 = parseFloat(display.value);
				result = calcular(operador, v1, v2);
				display.value = result;
				v1 = result;
				visor = false;
			}
		}
		
		function calcular(operador, n1, n2){
			if(operador == "+"){
				return n1 + n2;
			}else if(operador == "-"){
				return n1 - n2; 
			}else if(operador == "*"){
				return n1 * n2;
			}else if(operador == "/"){
				if(n2 == 0){
					return "Erro";
				}else{
					return n1 / n2; 
				}
			}else{
				return parseFloat(display.value);
			}
		}
		
		function excluir(e){
			e.preventDefault();
			if(result){
				display.value = "0";
				visor = false;
				v1 = null;
				v2 = null;
				operador = false;
				result = false;
			}else if(result == false){
				if(display.value.length -1 != 0){
					display.value = display.value.slice(0, display.value.length - 1);
				}else{
					display.value = "0";
				}
			}
			deletar.textContent = "Excluir";
		}
		
		window.onload = resize;
	</script>
</body>

</html>